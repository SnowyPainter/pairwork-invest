ì§€ê¸ˆ ë³µê°í•˜ë ¤ëŠ” **LocalBNS ëª¨ë¸ì˜ Buyer(ë§¤ìˆ˜ì)** ì™€ **Seller(ë§¤ë„ì)** ëª¨ë¸ì€ ê°ê° â€œì‹ ê³ ê°€ ëŒíŒŒ ì „/í›„ êµ­ë©´ì˜ ì‹œê³„ì—´ íŒ¨í„´â€ì„ í¬ì°©í•˜ëŠ” êµ¬ì¡°ì˜€ì£ .
ì¦‰, ë‹¨ìˆœíˆ ê°™ì€ ì§€í‘œë¥¼ ì“°ë”ë¼ë„ **BuyerëŠ” ë°˜ë“± ì „ ë³€ë™ì„± ìˆ˜ì¶•â€“ëª¨ë©˜í…€ íšŒë³µ íŒ¨í„´**,
**SellerëŠ” ê³¼ì—´ í›„ ë³€ë™ì„± í™•ì¥â€“ëª¨ë©˜í…€ ì´íƒˆ íŒ¨í„´**ì„ êµ¬ë³„í•´ì•¼ í•©ë‹ˆë‹¤.

---

## ğŸ§  1. Feature Philosophy

| ê´€ì            | Buyer ëª¨ë¸             | Seller ëª¨ë¸                 |
| ------------ | -------------------- | ------------------------- |
| **ì‹œì¥ ìƒíƒœ**    | ì‹ ê³ ê°€ ëŒíŒŒ ì§ì „, ë§¤ìˆ˜ì„¸ ìœ ì… êµ¬ê°„ | ì‹ ê³ ê°€ ëŒíŒŒ ì§í›„, ê³¼ì—´ ë° ë§¤ë„ì„¸ í™•ì‚° êµ¬ê°„ |
| **í•µì‹¬ ê°ì§€ ëª©í‘œ** | ë³€ê³¡ì  â€œê·¹ì†Œâ€ (ì €ì  ë°˜ë“±)     | ë³€ê³¡ì  â€œê·¹ëŒ€â€ (ê³ ì  í•˜ë½)          |
| **ì£¼ìš” ì‹ í˜¸ íŒ¨í„´** | ë³€ë™ì„± ê¸‰ìƒìŠ¹ + ëª¨ë©˜í…€ íšŒë³µ     | ì¶”ì„¸ ì´íƒˆ + ëª¨ë©˜í…€ ê¸‰ë½            |

---

## âš™ï¸ 2. Feature ëª©ë¡ ë° ê³„ì‚° ë°©ë²•

### (A) **ê³µí†µ ê¸°ë³¸ í”¼ì²˜**

ëª¨ë“  ëª¨ë¸ ê³µí†µìœ¼ë¡œ í•„ìš” (ê°€ê²©Â·ê±°ë˜Â·ì¶”ì„¸ ê¸°ë°˜)

| Feature       | ì˜ë¯¸                  | ê³„ì‚° ë°©ë²•                                          | ë¹„ê³           |
| ------------- | ------------------- | ---------------------------------------------- | ----------- |
| `log_return`  | ë¡œê·¸ ìˆ˜ìµë¥               | `np.log(close / close.shift(1))`               | ë…¸ì´ì¦ˆ ì œê±°ìš©     |
| `vol_roc`     | ê±°ë˜ëŸ‰ ë³€í™”ìœ¨             | `(volume - volume.shift(1)) / volume.shift(1)` | ê±°ë˜ëŸ‰ ëª¨ë©˜í…€     |
| `pos_in_band` | Bollinger band ë‚´ ìœ„ì¹˜ | `(close - lower) / (upper - lower)`            | ìƒëŒ€ì  ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„ |

---

### (B) ğŸŸ¢ Buyer ëª¨ë¸ìš© Feature Set (ì‹ ê³ ê°€ ì´ì „ êµ­ë©´)

> í•µì‹¬: **RSIÂ·MACDÂ·Bollinger í•˜ë‹¨ì˜ ìƒí˜¸ì‘ìš©**
> â†’ â€œê³¼ë§¤ë„ êµ¬ê°„ì—ì„œ ë°˜ë“± ì „ ì§•í›„â€ë¥¼ í¬ì°©

| êµ¬ë¶„          | Feature                               | ì˜ë¯¸           | ê³„ì‚° ë°©ë²•                                       | ì¶”ê°€ ê°œì„  ì•„ì´ë””ì–´                     |
| ----------- | ------------------------------------- | ------------ | ------------------------------------------- | ------------------------------ |
| **ëª¨ë©˜í…€**     | `RSI_14`, `Î”RSI_3`                    | ë§¤ìˆ˜ì„¸ íšŒë³µ ì—¬ë¶€    | `ta.rsi(close, 14)` / `.diff(3)`            | RSI 30â†’40 ëŒíŒŒ êµ¬ê°„ë§Œ ë§ˆìŠ¤í‚¹           |
| **ì¶”ì„¸ë³€í™”ìœ¨**   | `MACD`, `MACD_signal`, `Î”MACD`        | ëª¨ë©˜í…€ ë³€í™” ë°©í–¥    | `ta.macd(close)` / `.diff()`                | MACD íˆìŠ¤í† ê·¸ë¨ ê¸°ë°˜ slope feature ì¶”ê°€ |
| **ë°´ë“œ í¬ì§€ì…˜**  | `BB_lower`, `BB_upper`, `pos_in_band` | í•˜ë‹¨ ì´íƒˆ í›„ ë³µê·€   | `ta.bbands(close, 20, 2)`                   | í•˜ë‹¨ì„  ì´íƒˆ íšŸìˆ˜(rolling count)       |
| **ë³€ë™ì„±**     | `ATR_14`, `Î”ATR_3`                    | ë³€ë™ì„± ê¸‰ë“± ì „í™˜    | `ta.atr(high, low, close, 14)` / `.diff(3)` | ATR ìƒìŠ¹ìœ¨ ê¸‰ë³€ì‹œ ì‹ í˜¸ ê°•í™”              |
| **ì´í‰ì„  ìˆ˜ë ´ë„** | `EMA_5 - EMA_20`                      | ë‹¨ê¸°/ì¤‘ê¸° ì¶”ì„¸ ìˆ˜ë ´  | `ta.ema(close, 5) - ta.ema(close, 20)`      | ìˆ˜ë ´ë„ ì œê³±ê°’ìœ¼ë¡œ ì•ˆì •ì„± ë¶€ì—¬               |
| **ê±°ë˜ëŸ‰ ëª¨ë©˜í…€** | `Volume_Z`, `vol_roc`                 | ì €ì  ê±°ë˜ëŸ‰ í­ë°œ ê°ì§€ | `zscore(volume)`                            | ROC Ã— RSI ìƒê´€ê³„ìˆ˜                 |
| **íŒŒìƒ ì¡°í•©**   | `(Î”RSI Ã— Î”MACD)`, `(ATR / EMA_20)`    | ë³€ê³¡ ì‹ í˜¸ ì¦í­     | pandas ì—°ì‚°                                   | ì¡°í•© feature importanceë¡œ ì„ íƒ      |

**ğŸ‘‰ Labeling ì œì•ˆ**

* í–¥í›„ 3~5ì¼ ë‚´ `+2~3%` ì´ìƒ ìƒìŠ¹ ì‹œ `label_buy = 1`
* ê·¸ ì™¸ `0`

---

### (C) ğŸ”´ Seller ëª¨ë¸ìš© Feature Set (ì‹ ê³ ê°€ ì´í›„ êµ­ë©´)

> í•µì‹¬: **EMAÂ·SMA ì•ˆì •í™” + ATR ê¸‰ë“±**
> â†’ â€œê³¼ì—´ í›„ í•˜ë½ ì „í™˜â€ íŒ¨í„´ í¬ì°©

| êµ¬ë¶„          | Feature                          | ì˜ë¯¸         | ê³„ì‚° ë°©ë²•                                       | ì¶”ê°€ ê°œì„  ì•„ì´ë””ì–´                   |
| ----------- | -------------------------------- | ---------- | ------------------------------------------- | ---------------------------- |
| **ì¶”ì„¸**      | `EMA_5`, `EMA_20`, `Î”EMA_spread` | ë‹¨ê¸° ì¶”ì„¸ ë‘”í™”   | `ta.ema(close,5) - ta.ema(close,20)`        | EMA_slope = EMA.diff() í™œìš©    |
| **ë³€ë™ì„±**     | `ATR_14`, `Î”ATR_5`               | ë³€ë™ì„± í™•ì¥ ê°ì§€  | `ta.atr(high, low, close, 14)` / `.diff(5)` | Ïƒ-normalizationìœ¼ë¡œ ìƒëŒ€ì  ê³¼ì—´ íŒë‹¨  |
| **ëª¨ë©˜í…€ ì•½í™”**  | `RSI_14`, `RSI_7`, `Î”RSI`        | ê³¼ë§¤ìˆ˜â†’ê¸‰ë½ ì „í™˜  | `ta.rsi(close, 14)`                         | RSI>70â†’50 í•˜ë½ êµ¬ê°„ ë§ˆìŠ¤í‚¹          |
| **ë°´ë“œ í¬ì§€ì…˜**  | `pos_in_band`                    | ìƒë‹¨ ê·¼ì ‘ë„     | `(close - lower)/(upper-lower)`             | 0.9 ì´ìƒ ê³ ì • êµ¬ê°„ë§Œ                |
| **MACD ì—­ì „** | `MACD`, `Î”MACD`                  | ëª¨ë©˜í…€ ìƒì‹¤     | `ta.macd(close)`                            | MACD_cross = (MACD < Signal) |
| **ê±°ë˜ëŸ‰ ìˆ˜ì¶•**  | `vol_roc_neg`, `Volume_Z`        | ê±°ë˜ëŸ‰ ê°ì†Œ     | `vol_roc < 0`                               | RSIí•˜ë½ Ã— ê±°ë˜ëŸ‰ê°ì†Œ ì¡°í•©             |
| **ì¶”ê°€ ì‹ í˜¸**   | `BB_width`                       | ë°´ë“œ í­ í™•ëŒ€    | `(upper - lower)/mavg`                      | í­ì´ ê¸‰ê²©íˆ ë„“ì–´ì§€ëŠ” ì‹œì  ë§¤ë„ê°•ì„¸          |
| **íŒŒìƒ ì¡°í•©**   | `(Î”EMA_spread Ã— Î”ATR)`           | ì¶”ì„¸ë‘”í™”+ë³€ë™ì„±ê¸‰ë“± | pandas ì—°ì‚°                                   | ì¤‘ìš” ì¡°í•© feature ìë™ì¶”ì¶œ (SHAP ê¸°ë°˜) |

**ğŸ‘‰ Labeling ì œì•ˆ**

* í–¥í›„ 3~5ì¼ ë‚´ `-2~3%` ì´ìƒ í•˜ë½ ì‹œ `label_sell = 1`
* ê·¸ ì™¸ `0`

---

## ğŸ§© 3. Buyer/Seller Feature ê°„ ì°¨ì´ ìš”ì•½

| êµ¬ë¶„        | Buyer                        | Seller                           |
| --------- | ---------------------------- | -------------------------------- |
| í•µì‹¬ ì§€í‘œ     | RSI, MACD, Bollinger í•˜ë‹¨, ATR | EMA, SMA, ATR, RSI, Bollinger ìƒë‹¨ |
| ì‹ í˜¸ ë°©í–¥     | ê³¼ë§¤ë„ â†’ ë°˜ë“±                     | ê³¼ë§¤ìˆ˜ â†’ í•˜ë½                         |
| ì§€í‘œ ì¤‘ìš”ë„    | RSI > EMA > ATR > SMA        | EMA > ATR > RSI > SMA            |
| ì¶”ê°€ ì¡°í•©     | Î”RSI Ã— Î”MACD                 | Î”ATR Ã— Î”EMA_spread               |
| ì…ë ¥ ì‹œí€€ìŠ¤ ê¸¸ì´ | 20~30ì¼                       | 20~30ì¼                           |
| ë ˆì´ë¸”       | í–¥í›„ ìƒìŠ¹ìœ¨ ê¸°ì¤€                    | í–¥í›„ í•˜ë½ìœ¨ ê¸°ì¤€                        |

---

## ğŸ§  4. â€œë” ë‚˜ì€ í”¼ì²˜ë§â€ ì œì•ˆ (2025ë…„ì‹ ê³ ë„í™”)

| ê°œì„  ë°©í–¥                                   | ì„¤ëª…                                                   | êµ¬í˜„ íŒíŠ¸          |
| --------------------------------------- | ---------------------------------------------------- | -------------- |
| **(1) Local Volatility Index**          | `Ïƒ(close[-5:]) / Ïƒ(close[-20:])` ë¡œ ë‹¨ê¸°ë³€ë™ì„± ëŒ€ë¹„ ì¥ê¸°ë³€ë™ì„± ë¹„ìœ¨ | ê¸‰ë³€ ê°ì§€ì— ìœ ìš©      |
| **(2) Trend Momentum Divergence**       | `MACD - RSI` ê°„ divergence                            | ì¶”ì„¸ ì´íƒˆ ì¡°ê¸° í¬ì°©    |
| **(3) Rolling correlation(EMA5, ATR)`** | ë³€ë™ì„±ê³¼ ì¶”ì„¸ ê°„ ìƒê´€                                         | ê°•ì„¸â†’ì•½ì„¸ ì „í™˜ ì‹œ ë°˜ì „  |
| **(4) Volume-adjusted ATR (VATR)**      | `ATR / log(volume)`                                  | ê±°ë˜ëŸ‰ ë™ë°˜ ë³€ë™ì„± ë³´ì •  |
| **(5) Local Z-score of RSI**            | `(RSI - mean(RSI,20)) / std(RSI,20)`                 | ê³¼ë§¤ìˆ˜Â·ê³¼ë§¤ë„ ì •ê·œí™” íƒì§€ |
| **(6) Dynamic Bollinger Width ratio**   | `(BB_width - BB_width.shift(5))/BB_width.shift(5)`   | ë³€ë™ì„± í­ë°œ ì „ì¡° íƒì§€   |

---

## ğŸš€ 5. ì •ë¦¬ â€” ë³µê°ìš© Feature Extraction êµ¬ì¡° ì œì•ˆ

```python
def extract_features(df):
    import pandas_ta as ta
    df["RSI"] = ta.rsi(df["Close"], 14)
    df["EMA_5"], df["EMA_20"] = ta.ema(df["Close"], 5), ta.ema(df["Close"], 20)
    df["SMA_5"], df["SMA_20"] = ta.sma(df["Close"], 5), ta.sma(df["Close"], 20)
    df["ATR"] = ta.atr(df["High"], df["Low"], df["Close"], 14)
    bb = ta.bbands(df["Close"], 20, 2)
    df = pd.concat([df, bb], axis=1)
    df["MACD"], df["MACD_signal"], _ = ta.macd(df["Close"])
    df["vol_roc"] = df["Volume"].pct_change()
    df["pos_in_band"] = (df["Close"] - df["BBL_20_2.0"]) / (df["BBU_20_2.0"] - df["BBL_20_2.0"])
    df["Î”RSI"], df["Î”MACD"], df["Î”ATR"] = df["RSI"].diff(), df["MACD"].diff(), df["ATR"].diff()
    df["EMA_spread"] = df["EMA_5"] - df["EMA_20"]
    df["Î”EMA_spread"] = df["EMA_spread"].diff()
    df["BB_width"] = (df["BBU_20_2.0"] - df["BBL_20_2.0"]) / df["BBM_20_2.0"]
    return df.dropna()
```